{% extends 'baseTemplate.html' %}
{% load crispy_forms_tags %}

{% block css %} 
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
{% endblock %}

{% block content %}
<div class="container-fluid">
    <h2>ðŸ“„ Â¿QuÃ© se requiere? - {{ servicio.titulo }}</h2>

    <form method="post" enctype="multipart/form-data">
        {% csrf_token %}
        {{ form|crispy }}
        <button type="submit" class="btn btn-success">
            {% if modo_edicion %}Guardar cambios{% else %}Agregar requisito{% endif %}
        </button>
        <a href="{% url 'gestionar_servicio' servicio.id %}" class="btn btn-secondary">Volver</a>
    </form>

    <hr>

    <h4>Requisitos existentes</h4>
    <table class="table table-striped">
        <thead>
            <tr>
                <th>#</th>
                <th>Nombre</th>
                <th>Tipo</th>
                <th>Original</th>
                <th>Copia</th>
                <th>Archivo</th>
                <th>Opciones</th>
            </tr>
        </thead>
        <tbody>
            {% for r in requisitos %}
            <tr>
                <td>{{ forloop.counter }}</td>
                <td>{{ r.nombre }}</td>
                <td>{{ r.tipo_documento }}</td>
                <td>{{ r.presentar_original|yesno:"SÃ­,No" }}</td>
                <td>{{ r.presentar_copia|yesno:"SÃ­,No" }}</td>
                <td>
                    {% if r.archivo_descarga %}
                        <a href="{{ r.archivo_descarga.url }}" target="_blank">Descargar</a>
                    {% else %}
                        N/A
                    {% endif %}
                </td>
                <td>
                    <a href="{% url 'editar_requisito' servicio.id r.id %}" class="btn btn-sm btn-warning">
                        <i class="fas fa-edit"></i>
                    </a>
                    <form method="post" action="{% url 'eliminar_requisito' servicio.id r.id %}" style="display:inline;">
                        {% csrf_token %}
                        <button type="submit" class="btn btn-sm btn-danger" onclick="return confirm('Â¿EstÃ¡s seguro de eliminar este requisito?')">
                            <i class="fas fa-trash"></i>
                        </button>
                    </form>
                </td>
            </tr>
            {% empty %}
            <tr><td colspan="6" class="text-center">No hay requisitos registrados.</td></tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}