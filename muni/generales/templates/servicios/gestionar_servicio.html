{% extends 'baseTemplate.html' %}

{% block content %}
<div class="container-fluid">
    <div class="card shadow-lg">
        <div class="card-header">
            <h2 class="mb-0">
                üìå ¬øEn qu√© consiste?
            </h2>
        </div>

        <div class="card-body">
            {% if consiste %}
                <p><strong>Tr√°mite:</strong> {{ consiste.tramite }}</p>
                <p><strong>Canales de presentaci√≥n:</strong> {{ consiste.get_canales_presentacion_display }}</p>
                <p><strong>Solicitado por:</strong> {{ consiste.get_solicitado_por_display }}</p>
                <p><strong>Momento de solicitud:</strong> {{ consiste.momento_solicitud }}</p>
                <a href="{% url 'gestionar_consiste' servicio.id %}" class="btn btn-primary">Editar secci√≥n</a>
            {% else %}
                <a href="{% url 'gestionar_consiste' servicio.id %}" class="btn btn-primary">Agregar secci√≥n</a>
            {% endif %}
        </div>
    </div>

    <!-- Secci√≥n ¬øQu√© se requiere? -->
    <div class="card shadow-lg">
        <div class="card-header">
            <h2 class="mb-0">
                üìÑ ¬øQu√© se requiere?
            </h2>
        </div>

        <div class="card-body">
            {% if requisitos %}
                <ul class="list-group mb-3">
                    {% for r in requisitos %}
                    <li class="list-group-item">
                        <strong>{{ forloop.counter }}. {{ r.nombre }}</strong> ‚Äî 
                        Tipo: {{ r.tipo_documento }} |
                        Original: {{ r.presentar_original|yesno:"S√≠,No" }} |
                        Copia: {{ r.presentar_copia|yesno:"S√≠,No" }} |
                        {% if r.archivo_descarga %}
                            <a href="{{ r.archivo_descarga.url }}" target="_blank">üìÑ Descargar</a>
                        {% else %}
                            Sin archivo
                        {% endif %}
                    </li>
                    {% endfor %}
                </ul>
            {% else %}
                <p>No hay requisitos registrados a√∫n.</p>
            {% endif %}

            <a href="{% url 'gestionar_requisitos' servicio.id %}" class="btn btn-primary">Gestionar requisitos</a>
        </div>
    </div>

    <!-- Secci√≥n ¬øC√≥mo lo realizo? -->
    <div class="card shadow-lg">
        <div class="card-header">
            <h2 class="mb-0">
                üõ†Ô∏è ¬øC√≥mo lo realizo?
            </h2>
        </div>

        <div class="card-body">
            {% if instrucciones %}
                {% for canal, pasos in instrucciones.items %}
                    <h5>
                        {% if canal == "linea" %}
                            üíª En l√≠nea
                        {% elif canal == "presencial" %}
                            üè¢ Presencial
                        {% else %}
                            Otro
                        {% endif %}
                    </h5>
                    <ol>
                        {% for paso in pasos %}
                            <li>{{ paso.descripcion }}</li>
                        {% endfor %}
                    </ol>
                {% endfor %}
                    <a href="{% url 'gestionar_realizo' servicio.id %}" class="btn btn-primary">Gestionar pasos</a>
            {% else %}
                <a href="{% url 'gestionar_realizo' servicio.id %}" class="btn btn-primary">Agregar pasos</a>
            {% endif %}
        </div>
    </div>

    <!-- Secci√≥n ¬øCu√°nto cuesta? -->
    <div class="card shadow-lg">
        <div class="card-header">
            <h2 class="mb-0">
                üí∞ ¬øCu√°nto cuesta?
            </h2>
        </div>

        <div class="card-body">
            {% if costos %}
                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Concepto</th>
                            <th>Notas</th>
                            <th>Vigencia</th>
                            <th>Tipo</th>
                            <th>Costo</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for costo in costos %}
                        <tr>
                            <td>{{ forloop.counter }}</td>
                            <td>{{ costo.concepto }}</td>
                            <td>{{ costo.notas|default:"-" }}</td>
                            <td>{{ costo.vigencia }}</td>
                            <td>{{ costo.tipo }}</td>
                            <td>{{ costo.costo }}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
                <br>
                <a href="{% url 'gestionar_costos' servicio.id %}" class="btn btn-primary">Gestionar costos</a>
            {% else %}
                <p>No hay costos registrados.</p>
                <a href="{% url 'gestionar_costos' servicio.id %}" class="btn btn-primary">Agregar costos</a>
            {% endif %}
        </div>
    </div>

</div>
{% endblock %}
