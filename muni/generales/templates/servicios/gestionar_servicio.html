{% extends 'baseTemplate.html' %}
{% block content %}
<div class="container-fluid">
    <h2>Gestionar Servicio: {{ servicio.titulo }}</h2>

    <!-- SecciÃ³n Â¿En quÃ© consiste? -->
    <div class="card mt-4">
        <div class="card-header">
            ğŸ“Œ Â¿En quÃ© consiste?
        </div>
        <div class="card-body">
            {% if consiste %}
                <p><strong>TrÃ¡mite:</strong> {{ consiste.tramite }}</p>
                <p><strong>Canales de presentaciÃ³n:</strong> {{ consiste.get_canales_presentacion_display }}</p>
                <p><strong>Solicitado por:</strong> {{ consiste.get_solicitado_por_display }}</p>
                <p><strong>Momento de solicitud:</strong> {{ consiste.momento_solicitud }}</p>
                <a href="{% url 'gestionar_consiste' servicio.id %}" class="btn btn-outline-primary">Editar secciÃ³n</a>
            {% else %}
                <a href="{% url 'gestionar_consiste' servicio.id %}" class="btn btn-success">Agregar secciÃ³n</a>
            {% endif %}
        </div>
    </div>

    <!-- SecciÃ³n Â¿QuÃ© se requiere? -->
    <div class="card mt-4">
        <div class="card-header">
            ğŸ“„ Â¿QuÃ© se requiere?
        </div>
        <div class="card-body">
            {% if requisitos %}
                <ul class="list-group mb-3">
                    {% for r in requisitos %}
                    <li class="list-group-item">
                        <strong>{{ forloop.counter }}. {{ r.nombre }}</strong> â€” 
                        Tipo: {{ r.tipo_documento }} |
                        Original: {{ r.presentar_original|yesno:"SÃ­,No" }} |
                        Copia: {{ r.presentar_copia|yesno:"SÃ­,No" }} |
                        {% if r.archivo_descarga %}
                            <a href="{{ r.archivo_descarga.url }}" target="_blank">ğŸ“„ Descargar</a>
                        {% else %}
                            Sin archivo
                        {% endif %}
                    </li>
                    {% endfor %}
                </ul>
            {% else %}
                <p>No hay requisitos registrados aÃºn.</p>
            {% endif %}

            <a href="{% url 'gestionar_requisitos' servicio.id %}" class="btn btn-outline-primary">Gestionar requisitos</a>
        </div>
    </div>

    <!-- SecciÃ³n Â¿CÃ³mo lo realizo? -->
    <div class="card mt-4">
        <div class="card-header">
            ğŸ› ï¸ Â¿CÃ³mo lo realizo?
        </div>
        <div class="card-body">
            {% if instrucciones %}
                {% for canal, pasos in instrucciones.items %}
                    <h5>
                        {% if canal == "linea" %}
                            ğŸ’» En lÃ­nea
                        {% elif canal == "presencial" %}
                            ğŸ¢ Presencial
                        {% else %}
                            Otro
                        {% endif %}
                    </h5>
                    <ol>
                        {% for paso in pasos %}
                            <li>{{ paso.descripcion }}</li>
                        {% endfor %}
                    </ol>
                {% endfor %}
                    <a href="{% url 'gestionar_realizo' servicio.id %}" class="btn btn-outline-primary">Gestionar pasos</a>
            {% else %}
                <a href="{% url 'gestionar_realizo' servicio.id %}" class="btn btn-success">Agregar pasos</a>
            {% endif %}
        </div>
    </div>

</div>
{% endblock %}
