{% extends 'baseTemplate.html' %}
{% block content %}
<div class="container-fluid">
    <h2>Gestionar Servicio: {{ servicio.titulo }}</h2>

    <!-- Sección ¿En qué consiste? -->
    <div class="card mt-4">
        <div class="card-header">
            📌 ¿En qué consiste?
        </div>
        <div class="card-body">
            {% if consiste %}
                <p><strong>Trámite:</strong> {{ consiste.tramite }}</p>
                <p><strong>Canales de presentación:</strong> {{ consiste.get_canales_presentacion_display }}</p>
                <p><strong>Solicitado por:</strong> {{ consiste.get_solicitado_por_display }}</p>
                <p><strong>Momento de solicitud:</strong> {{ consiste.momento_solicitud }}</p>
                <a href="{% url 'gestionar_consiste' servicio.id %}" class="btn btn-outline-primary">Editar sección</a>
            {% else %}
                <a href="{% url 'gestionar_consiste' servicio.id %}" class="btn btn-success">Agregar sección</a>
            {% endif %}
        </div>
    </div>

    <!-- Sección ¿Qué se requiere? -->
    <div class="card mt-4">
        <div class="card-header">
            📄 ¿Qué se requiere?
        </div>
        <div class="card-body">
            {% if requisitos %}
                <ul class="list-group mb-3">
                    {% for r in requisitos %}
                    <li class="list-group-item">
                        <strong>{{ forloop.counter }}. {{ r.nombre }}</strong> — 
                        Tipo: {{ r.tipo_documento }} |
                        Original: {{ r.presentar_original|yesno:"Sí,No" }} |
                        Copia: {{ r.presentar_copia|yesno:"Sí,No" }} |
                        {% if r.archivo_descarga %}
                            <a href="{{ r.archivo_descarga.url }}" target="_blank">📄 Descargar</a>
                        {% else %}
                            Sin archivo
                        {% endif %}
                    </li>
                    {% endfor %}
                </ul>
            {% else %}
                <p>No hay requisitos registrados aún.</p>
            {% endif %}

            <a href="{% url 'gestionar_requisitos' servicio.id %}" class="btn btn-outline-primary">Gestionar requisitos</a>
        </div>
    </div>

    <!-- Sección ¿Cómo lo realizo? -->
    <div class="card mt-4">
        <div class="card-header">
            🛠️ ¿Cómo lo realizo?
        </div>
        <div class="card-body">
            {% if instrucciones %}
                {% for canal, pasos in instrucciones.items %}
                    <h5>
                        {% if canal == "linea" %}
                            💻 En línea
                        {% elif canal == "presencial" %}
                            🏢 Presencial
                        {% else %}
                            Otro
                        {% endif %}
                    </h5>
                    <ol>
                        {% for paso in pasos %}
                            <li>{{ paso.descripcion }}</li>
                        {% endfor %}
                    </ol>
                {% endfor %}
                    <a href="{% url 'gestionar_realizo' servicio.id %}" class="btn btn-outline-primary">Gestionar pasos</a>
            {% else %}
                <a href="{% url 'gestionar_realizo' servicio.id %}" class="btn btn-success">Agregar pasos</a>
            {% endif %}
        </div>
    </div>

</div>
{% endblock %}
