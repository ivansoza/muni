{% extends "base.html" %}
{% load static %}

{% block extra_css %}
    <link rel="stylesheet" href="{% static 'css/servicios/estilos_detalle.css' %}">
{% endblock %}

{% block content %}
<div class="container">
    <!-- Encabezado del trÃ¡mite -->
    <div class="header">
        <p class="breadcrumb">
            {{ servicio.organismo.nombre }} / {{ servicio.clasificacion.nombre }}
        </p>
        <h1 class="title">{{ servicio.titulo }}</h1>
        <p class="subtitle">
            Esta modalidad pertenece al trÃ¡mite de {{ servicio.clasificacion.nombre }}
        </p>
    </div>

    <!-- Sidebar solo con iconos en mÃ³viles -->
    <div class="sidebar responsive-sidebar">
        <ul class="menu">
            <li class="active"><i class="fas fa-thumbtack"></i></li>
            <li><i class="fas fa-file-alt"></i></li>
            <li><i class="fas fa-tools"></i></li>
            <li><i class="fas fa-map-marker-alt"></i></li>
            <li><i class="fas fa-money-bill-wave"></i></li>
            <li><i class="fas fa-university"></i></li>
            <li><i class="fas fa-calendar-alt"></i></li>
            <li><i class="fas fa-clipboard-check"></i></li>
        </ul>
    </div>

    <!-- Contenedor de contenido principal -->
    <div class="content-wrapper">
        <!-- MenÃº lateral en pantallas grandes -->
        <div class="sidebar desktop-sidebar">
            <ul class="menu">
                <li class="menu-item active" data-seccion="seccion-consiste">ğŸ“Œ Â¿En quÃ© consiste?</li>
                <li class="menu-item" data-seccion="seccion-requisitos">ğŸ“„ Â¿QuÃ© se requiere?</li>
                <li class="menu-item" data-seccion="seccion-realizo">ğŸ› ï¸ Â¿CÃ³mo lo realizo?</li>
                <li class="menu-item" data-seccion="seccion-presencial">ğŸ“ Â¿DÃ³nde lo realizo presencial?</li>
                <li class="menu-item" data-seccion="seccion-costo">ğŸ’° Â¿CuÃ¡nto cuesta?</li>
                <li class="menu-item" data-seccion="seccion-pago">ğŸ¦ Â¿DÃ³nde lo pago?</li>
                <li class="menu-item" data-seccion="seccion-plazos">ğŸ“† Plazos y criterios de resoluciÃ³n</li>
                <li class="menu-item" data-seccion="seccion-inspeccion">ğŸ“‘ InspecciÃ³n y verificaciÃ³n</li>
            </ul>
        </div>

        <!-- SecciÃ³n "Â¿En quÃ© consiste?" -->
        <div id="seccion-consiste" class="seccion">
            <h2>InformaciÃ³n del TrÃ¡mite</h2>
            <div class="info-grid">
                <div class="info-item">
                    <strong>TrÃ¡mite:</strong>
                    <span class="badge costo">{{ consiste.tramite }}</span>
                </div>
                <div class="info-item">
                    <strong>Sector EconÃ³mico:</strong> 
                    <span class="economico">{{ servicio.sector.nombre }}</span>
                </div>
                <div class="info-item">
                    <strong>Canales de presentaciÃ³n:</strong> 
                    <span class="badge presencial">{{ consiste.get_canales_presentacion_display }}</span>
                </div>
            </div>

            <div class="descripcion">
                <h3>DescripciÃ³n:</h3>
                <p>{{ servicio.descripcion }}</p>
            </div>

            <div class="info-grid">
                <div class="info-item">
                    <strong>Puede ser solicitado por:</strong> 
                    {{ consiste.get_solicitado_por_display }}
                </div>
                <div class="info-item">
                    <strong>En quÃ© momento se deberÃ¡ solicitar:</strong> 
                    {{ consiste.momento_solicitud }}
                </div>
            </div>
        </div>

        <!-- SecciÃ³n "Â¿QuÃ© se requiere?" -->
        <div id="seccion-requisitos" class="seccion">
            <h2>Requisitos</h2>
            
            <table class="tabla-requisitos">
                <thead>
                    <tr>
                        <th>Documento</th>
                        <th>Especificaciones</th>
                        <th>Tipo de documentos</th>
                        <th>Presentar en</th>
                        <th>Descargar</th>
                    </tr>
                </thead>
                <tbody>
                    {% for requisito in requiere %}
                    <tr>
                        <td>{{ forloop.counter }}. {{ requisito.nombre }}</td>
                        <td>{{ requisito.especificaciones }}</td>
                        <td>{{ requisito.tipo_documento }}</td>
                        <td>Original ({{ requisito.presentar_original }}) / Copia ({{ requisito.presentar_copia }})</td>
                        <td>
                            {% if requisito.archivo_descarga %}
                                <a href="{{ requisito.archivo_descarga.url }}" target="_blank">Descargar documento</a>
                            {% else %}
                                N/A
                            {% endif %}
                        </td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="5" class="text-center">No se requieren documentos.</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>

    <!-- Botones de acciÃ³n -->
    <div class="action-buttons">
        <a href="{% url 'homeServicios' %}" class="btn btn-secondary">â† Regresar</a>
        <a href="#" class="btn btn-warning">âš ï¸ Presentar una queja</a>
    </div>    
</div>
{% endblock %}

{% block extra_js %}
<script>
    document.addEventListener("DOMContentLoaded", function() {
        const menuItems = document.querySelectorAll(".menu-item");
        const sections = document.querySelectorAll(".seccion");

        menuItems.forEach(item => {
            item.addEventListener("click", function() {
                // Remover clase "active" de todos los elementos del menÃº
                menuItems.forEach(i => i.classList.remove("active"));
                this.classList.add("active");

                // Ocultar todas las secciones
                sections.forEach(sec => sec.style.display = "none");

                // Mostrar la secciÃ³n seleccionada
                const seccionId = this.getAttribute("data-seccion");
                document.getElementById(seccionId).style.display = "block";
            });
        });

        // Mostrar solo la primera secciÃ³n por defecto
        document.getElementById("seccion-consiste").style.display = "block";
    });
</script>
{% endblock %}